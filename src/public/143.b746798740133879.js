"use strict";(self.webpackChunkdesafio_final_front=self.webpackChunkdesafio_final_front||[]).push([[143],{1143:(S,f,s)=>{s.r(f),s.d(f,{PrivateAppModule:()=>w});var l=s(6895),u=s(9965),t=s(8256),d=s(6221),a=s(4766),_=s(529);let m=(()=>{class r{constructor(e){this.http=e}getProducts(e){return this.http.get(`${a.N.urlFetch}/products/completelist?page=${e}`)}deleteProduct(e){return this.http.delete(`${a.N.urlFetch}/products/delete/${e}`)}addProduct(e){return this.http.post(`${a.N.urlFetch}/products/insert`,e)}updateProduct(e,o){return this.http.put(`${a.N.urlFetch}/products/update/${e}`,o)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(_.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var v=s(7316),i=s(433),b=s(1135);let g=(()=>{class r{constructor(e){this.http=e,this.myNumber$=new b.X(0)}get myNumberObservable(){return this.myNumber$.asObservable()}getProductsFromCartByEmail(e){return this.http.get(`${a.N.urlFetch}/cart/${e}`)}addProductsOnCartByMail(e,o){return this.myNumber$.next(42),this.http.post(`${a.N.urlFetch}/cart/${e}`,o)}deleteProducOfCart(e,o){return this.http.put(`${a.N.urlFetch}/cart/${e}`,o)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(_.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function P(r,c){if(1&r&&(t.TgZ(0,"div")(1,"form",10)(2,"label",11),t._uU(3," Producto: "),t._UZ(4,"input",12),t.qZA(),t.TgZ(5,"label",11),t._uU(6,"Descripcion: "),t._UZ(7,"input",13),t.qZA(),t.TgZ(8,"label",11),t._uU(9,"Categoria: "),t._UZ(10,"input",14),t.qZA(),t.TgZ(11,"label",11),t._uU(12," C\xf3digo del produto: "),t._UZ(13,"input",15),t.qZA(),t.TgZ(14,"label",11),t._uU(15," URL del producto: "),t._UZ(16,"input",16),t.qZA(),t.TgZ(17,"label",11),t._uU(18," Precio: "),t._UZ(19,"input",17),t.qZA(),t.TgZ(20,"label",11),t._uU(21," Stock: "),t._UZ(22,"input",18),t.qZA()()()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.formProduct)}}function Z(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addToCart())}),t._uU(2,"Agregar al carrito"),t.qZA(),t.TgZ(3,"div",21)(4,"div",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.substractCant())}),t._uU(5,"-"),t.qZA(),t.TgZ(6,"div",23),t._uU(7),t.qZA(),t.TgZ(8,"div",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.addCant())}),t._uU(9,"+"),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(7),t.Oqu(e.cant)}}function x(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",24)(1,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteProduct())}),t._uU(2,"Eliminar"),t.qZA(),t.TgZ(3,"button",26),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.updateProduct())}),t._uU(4,"Actualizar"),t.qZA()()}}let T=(()=>{class r{constructor(e,o,n){this.dataProductsSvs=e,this.authService=o,this.cartService=n,this.changeList=new t.vpe,this.userRole="user",this.userEmail="",this.formProduct=new i.cw({}),this.administrador=!1,this.cant=1}ngOnInit(){this.formProduct=new i.cw({product:new i.NI(this.infoProduct.product,[i.kI.required]),description:new i.NI(this.infoProduct.description,[i.kI.required]),category:new i.NI(this.infoProduct.category,[i.kI.required]),code:new i.NI(this.infoProduct.code,[i.kI.required]),urlImgProduct:new i.NI(this.infoProduct.urlImgProduct,[i.kI.required]),price:new i.NI(this.infoProduct.price,[i.kI.required]),stock:new i.NI(this.infoProduct.stock,[i.kI.required])}),this.authService.getCookie().subscribe({next:e=>{this.userRole=e.message.role,this.userEmail=e.message.email,"admin"==this.userRole&&(this.administrador=!0)},error:e=>console.log(e)})}deleteProduct(){confirm(`\xbfRealmente quer\xe9s borrar el producto: ${this.infoProduct.product}`)&&(this.dataProductsSvs.deleteProduct(this.infoProduct.code).subscribe({next:()=>this.changeList.emit(),error:o=>console.log(o)}),this.changeList.emit())}updateProduct(){this.formProduct.get("product")?.errors?.required||this.formProduct.get("description")?.errors?.required||this.formProduct.get("category")?.errors?.required||this.formProduct.get("code")?.errors?.required||this.formProduct.get("urlImgProduct")?.errors?.required||this.formProduct.get("price")?.errors?.required||this.formProduct.get("stock")?.errors?.required?alert("Todos los campos deben estar completos"):this.dataProductsSvs.updateProduct(this.infoProduct.code,this.formProduct.value).subscribe({next:()=>this.changeList.emit(),error:e=>console.log(e)})}addCant(){this.cant<this.infoProduct.stock&&this.cant++}substractCant(){this.cant>1&&this.cant--}addToCart(){this.infoProduct.cant=this.cant,this.cartService.addProductsOnCartByMail(this.userEmail,this.infoProduct).subscribe({next:()=>{this.infoProduct.stock-=this.cant,this.cant=0==this.infoProduct.stock?0:1},error:e=>console.log(e)})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(m),t.Y36(d.e),t.Y36(g))},r.\u0275cmp=t.Xpm({type:r,selectors:[["front-card"]],inputs:{infoProduct:"infoProduct"},outputs:{changeList:"changeList"},decls:15,vars:8,consts:[[1,"card","m-3",2,"width","15rem"],[1,"card-img-top",2,"max-height","150px!important","min-height","150px!important",3,"src"],[1,"card-body",2,"max-height","150px!important","min-height","150px!important"],[1,"card-title"],[1,"card-text"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[4,"ngIf"],["class","card-body d-flex flex-column justify-content-center align-items-center",4,"ngIf"],["class","card-body",4,"ngIf"],["action","",1,"container","d-flex","flex-column",3,"formGroup"],["for",""],["formControlName","product","placeholder","Nombre del producto","type","text"],["formControlName","description","placeholder","Descripci\xf3n del producto","type","text"],["formControlName","category","placeholder","Categoria","type","text"],["formControlName","code","placeholder","C\xf3digo del producto","type","number","readonly",""],["formControlName","urlImgProduct","placeholder","URL de la foto","type","text"],["formControlName","price","placeholder","Precio","type","number"],["formControlName","stock","placeholder","Stock","type","number"],[1,"card-body","d-flex","flex-column","justify-content-center","align-items-center"],[1,"btn","btn-success","ms-3",3,"click"],[1,"d-flex","flex-row","flex-wrap","mt-3"],[1,"btn","btn-secondary",3,"click"],[1,"ms-2","me-2",2,"font-size","1.5rem"],[1,"card-body"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-warning","ms-3",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"img",1),t.TgZ(2,"div",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"p",4),t._uU(6),t.qZA()(),t.TgZ(7,"ul",5)(8,"li",6),t._uU(9),t.qZA(),t.TgZ(10,"li",6),t._uU(11),t.qZA()(),t.YNc(12,P,23,1,"div",7),t.YNc(13,Z,10,1,"div",8),t.YNc(14,x,5,0,"div",9),t.qZA()),2&e&&(t.xp6(1),t.s9C("src",o.infoProduct.urlImgProduct,t.LSH),t.xp6(3),t.Oqu(o.infoProduct.product),t.xp6(2),t.Oqu(o.infoProduct.description),t.xp6(3),t.hij("Precio: U$S ",o.infoProduct.price,""),t.xp6(2),t.hij("Stock: ",o.infoProduct.stock,""),t.xp6(1),t.Q6J("ngIf",o.administrador),t.xp6(1),t.Q6J("ngIf",!o.administrador),t.xp6(1),t.Q6J("ngIf",o.administrador))},dependencies:[i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,l.O5],styles:["input[_ngcontent-%COMP%]{border-radius:5px;margin-top:3px}"]}),r})(),k=(()=>{class r{constructor(e,o){this.authsvc=e,this.productsvc=o,this.formProduct=new i.cw({}),this.changeList=new t.vpe}ngOnInit(){this.formProduct=new i.cw({product:new i.NI("",[i.kI.required]),description:new i.NI("",[i.kI.required]),category:new i.NI("",[i.kI.required]),code:new i.NI("",[i.kI.required]),urlImgProduct:new i.NI("",[i.kI.required]),price:new i.NI("",[i.kI.required]),stock:new i.NI("",[i.kI.required,i.kI.min(0)])})}addproduct(){this.formProduct.valid?alert("Todos los campos deben estar completos"):this.productsvc.addProduct(this.formProduct.value).subscribe({next:e=>{0==e.status?(alert(`Producto a\xf1adido correctamente con el id: ${e.message._id}`),this.changeList.emit()):alert(`${e.message}`)},error:e=>console.log(e)})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(d.e),t.Y36(m))},r.\u0275cmp=t.Xpm({type:r,selectors:[["front-form"]],outputs:{changeList:"changeList"},decls:9,vars:1,consts:[["action","",1,"d-flex","flex-column",3,"formGroup"],["formControlName","product","placeholder","Nombre del producto","type","text"],["formControlName","description","placeholder","Descricti\xf3n del producto","type","text"],["formControlName","category","placeholder","Categoria","type","text"],["formControlName","code","placeholder","C\xf3digo del producto","type","number"],["formControlName","urlImgProduct","placeholder","URL de la foto","type","text"],["formControlName","price","placeholder","Precio","type","number"],["formControlName","stock","placeholder","Stock","type","number"],["type","submit","value","Ingresar producto",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t._UZ(1,"input",1)(2,"input",2)(3,"input",3)(4,"input",4)(5,"input",5)(6,"input",6)(7,"input",7),t.TgZ(8,"input",8),t.NdJ("click",function(){return o.addproduct()}),t.qZA()()),2&e&&t.Q6J("formGroup",o.formProduct)},dependencies:[i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u],styles:["input[_ngcontent-%COMP%]{margin-top:4px;border-radius:5px}"]}),r})(),C=(()=>{class r{constructor(e,o,n){this.authService=e,this.router=o,this.cartServices=n,this.numberOfProductsOnCart=0}ngOnInit(){this.authService.getCookie().subscribe({next:e=>{this.userImg=e.message.userImg,this.userName=e.message.completeName},error:e=>console.log(e)}),this.cartServices.myNumberObservable.subscribe({next:e=>{this.numberOfProductsOnCart=e},error:e=>console.log(e)})}close(){this.authService.deleteCookie().subscribe({next:e=>console.log(e.message),error:e=>console.log(e)}),this.router.navigate(["auth","login"])}goToCart(){this.router.navigate(["home","cart"])}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(d.e),t.Y36(u.F0),t.Y36(g))},r.\u0275cmp=t.Xpm({type:r,selectors:[["front-navbar"]],decls:24,vars:3,consts:[[1,"navbar","navbar-expand-lg","bg-light"],[1,"container-fluid"],[1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"me-2"],[1,"me-2",2,"max-height","50px","min-height","50px","max-width","50px","max-width","50px",3,"src"],[1,"btn","btn-outline-success",3,"click"],[1,"btn","btn-primary","ms-3","pe-4",2,"position","relative",3,"click"],["id","botonCart"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0","ms-5"],[1,"nav-item"],["role","search",1,"d-flex"],["type","search","placeholder","Filtr\xe1 por categorias","aria-label","Search",1,"form-control","me-2"],["type","submit",1,"btn","btn-outline-success"]],template:function(e,o){1&e&&(t.TgZ(0,"nav",0)(1,"div",1)(2,"div",2),t._uU(3,"JTS"),t.qZA(),t.TgZ(4,"button",3),t._UZ(5,"span",4),t.qZA(),t.TgZ(6,"div",5)(7,"div",6),t._uU(8),t.qZA(),t._UZ(9,"img",7),t.TgZ(10,"div",8),t.NdJ("click",function(){return o.close()}),t._uU(11,"Cerrrar sesi\xf3n"),t.qZA(),t.TgZ(12,"div",9),t.NdJ("click",function(){return o.goToCart()}),t._uU(13,"Ir al carrito "),t.TgZ(14,"div",10),t._uU(15),t.qZA()(),t.TgZ(16,"ul",11)(17,"li",12)(18,"div"),t._uU(19,"Home"),t.qZA()()(),t.TgZ(20,"form",13),t._UZ(21,"input",14),t.TgZ(22,"button",15),t._uU(23," Buscar "),t.qZA()()()()()),2&e&&(t.xp6(8),t.hij(" Bienvenido ",o.userName," "),t.xp6(1),t.s9C("src",o.userImg,t.LSH),t.xp6(6),t.Oqu(o.numberOfProductsOnCart))},dependencies:[i._Y,i.JL],styles:["#botonCart[_ngcontent-%COMP%]{width:20px;height:20px;background-color:red;color:#fff;border-radius:50%;position:absolute;right:5px;bottom:7px;display:flex;justify-content:center;align-items:center}"]}),r})();function N(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"front-form",9),t.NdJ("changeList",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.callBakcend())}),t.qZA()}}function y(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"front-card",10),t.NdJ("changeList",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.callBakcend())}),t.qZA()}2&r&&t.Q6J("infoProduct",c.$implicit)}function U(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"li",11),t.NdJ("click",function(){const p=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.pagination(p))}),t.TgZ(1,"a",12),t._uU(2),t.qZA()()}if(2&r){const e=c.$implicit;t.Gre("page-item ",e.class,""),t.xp6(2),t.Oqu(e.i)}}function F(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",5),t.NdJ("click",function(){const p=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.deleteProduct(p))}),t._uU(10,"X"),t.qZA()()}if(2&r){const e=c.$implicit;t.xp6(2),t.Oqu(e.product),t.xp6(2),t.hij("U$S ",e.price,""),t.xp6(2),t.Oqu(e.cant),t.xp6(2),t.hij("U$S ",e.cant*e.price,"")}}const A=[{path:"",component:(()=>{class r{constructor(e,o,n,p){this.authService=e,this.router=o,this.productsServices=n,this.authGuard=p,this.pages=[],this.actualPage=1,this.showFormAdmin=!1,this.allproducts=[],this.prevClass="disabled",this.nextClass=""}ngOnInit(){this.authService.getCookie().subscribe({next:e=>{this.userRole=e.message.role,"admin"==this.userRole&&(this.showFormAdmin=!0)},error:e=>console.log(e)}),this.callBakcend()}callBakcend(){this.productsServices.getProducts(1).subscribe({next:e=>{this.allproducts=e.data.products;for(let o=1;o<=e.data.pages;o++){let n={class:""};n.i=o,this.pages.push(n)}this.pages[0].class="active"},error:e=>console.log(e)})}prevPage(){if(this.actualPage>1){this.actualPage-=1,this.productsServices.getProducts(this.actualPage).subscribe({next:e=>this.allproducts=e.data.products,error:e=>console.log(e)});for(let e=0;e<=this.pages.length-1;e++)this.pages[e].class="";this.pages[this.actualPage-1].class="active"}this.prevClass=1==this.actualPage?"disabled":"",this.nextClass=this.actualPage==this.pages.length?"disabled":""}postPage(){if(this.actualPage<this.pages.length){this.actualPage+=1,this.productsServices.getProducts(this.actualPage).subscribe({next:e=>this.allproducts=e.data.products,error:e=>console.log(e)});for(let e=0;e<=this.pages.length-1;e++)this.pages[e].class="";this.pages[this.actualPage-1].class="active"}this.prevClass=1==this.actualPage?"disabled":"",this.nextClass=this.actualPage==this.pages.length?"disabled":""}pagination(e){for(let o=0;o<=this.pages.length-1;o++)this.pages[o].class="";this.actualPage=e.i,e.class="active",this.productsServices.getProducts(this.actualPage).subscribe({next:o=>this.allproducts=o.data.products,error:o=>console.log(o)}),this.prevClass=1==this.actualPage?"disabled":"",this.nextClass=this.actualPage==this.pages.length?"disabled":""}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(d.e),t.Y36(u.F0),t.Y36(m),t.Y36(v.a))},r.\u0275cmp=t.Xpm({type:r,selectors:[["front-home-page"]],decls:14,vars:9,consts:[[1,"container","mt-5"],[3,"changeList",4,"ngIf"],[1,"d-flex","flex-row","flex-wrap"],[3,"infoProduct","changeList",4,"ngFor","ngForOf"],["aria-label","..."],[1,"pagination"],[2,"cursor","pointer",3,"click"],[1,"page-link"],[3,"class","click",4,"ngFor","ngForOf"],[3,"changeList"],[3,"infoProduct","changeList"],[3,"click"],[1,"page-link",2,"cursor","pointer"]],template:function(e,o){1&e&&(t._UZ(0,"front-navbar"),t.TgZ(1,"div",0),t.YNc(2,N,1,0,"front-form",1),t.TgZ(3,"div",2),t.YNc(4,y,1,1,"front-card",3),t.qZA(),t.TgZ(5,"nav",4)(6,"ul",5)(7,"li",6),t.NdJ("click",function(){return o.prevPage()}),t.TgZ(8,"a",7),t._uU(9,"Anterior"),t.qZA()(),t.YNc(10,U,3,4,"li",8),t.TgZ(11,"li",6),t.NdJ("click",function(){return o.postPage()}),t.TgZ(12,"a",7),t._uU(13,"Siguiente"),t.qZA()()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.showFormAdmin),t.xp6(2),t.Q6J("ngForOf",o.allproducts),t.xp6(3),t.Gre("page-item ",o.prevClass,""),t.xp6(3),t.Q6J("ngForOf",o.pages),t.xp6(1),t.Gre("page-item  ",o.nextClass,""))},dependencies:[l.sg,l.O5,T,k,C]}),r})()},{path:"cart",component:(()=>{class r{constructor(e,o,n){this.router=e,this.authService=o,this.cartService=n,this.cartUser=[],this.emailUser=""}ngOnInit(){this.authService.getCookie().subscribe({next:e=>{this.emailUser=e.message.email,this.cartService.getProductsFromCartByEmail(e.message.email).subscribe({next:o=>{this.cartUser=o.info},error:o=>console.log(o)})},error:e=>console.log(e)})}goToHome(){this.router.navigate(["home"])}deleteProduct(e){confirm(`\xbfRealmente quer\xe9s borrar: ${e.product}?`)&&this.cartService.deleteProducOfCart(this.emailUser,{code:e.code}).subscribe({next:()=>this.cartUser=this.cartUser.filter(n=>n.code!=e.code),error:n=>console.log(n)})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(u.F0),t.Y36(d.e),t.Y36(g))},r.\u0275cmp=t.Xpm({type:r,selectors:[["front-cart-page"]],decls:21,vars:1,consts:[[1,"container","mt-5"],[1,"btn","btn-primary",3,"click"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],[2,"color","red","cursor","pointer",3,"click"]],template:function(e,o){1&e&&(t._UZ(0,"front-navbar"),t.TgZ(1,"section",0)(2,"h3"),t._uU(3,"Carrito"),t.qZA(),t.TgZ(4,"div",1),t.NdJ("click",function(){return o.goToHome()}),t._uU(5,"Ir al home"),t.qZA(),t.TgZ(6,"table",2)(7,"thead")(8,"tr")(9,"th",3),t._uU(10,"Producto"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Precio"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Cantidad de art\xedculos"),t.qZA(),t.TgZ(15,"th",3),t._uU(16,"Subtotal"),t.qZA(),t.TgZ(17,"th",3),t._uU(18,"Eliminar producto"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,F,11,4,"tr",4),t.qZA()()()),2&e&&(t.xp6(20),t.Q6J("ngForOf",o.cartUser))},dependencies:[l.sg,C]}),r})()}];let I=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[u.Bz.forChild(A),u.Bz]}),r})(),w=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[i.UX,l.ez,I]}),r})()}}]);